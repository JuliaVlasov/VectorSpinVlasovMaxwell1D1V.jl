<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · VectorSpinVlasovMaxwell1D1V.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://JuliaVlasov.github.io/VectorSpinVlasovMaxwell1D1V.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>VectorSpinVlasovMaxwell1D1V.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Scalar-spin-laser-plasma-model"><span>Scalar spin laser plasma model</span></a></li><li><a class="tocitem" href="#Time-discretization:-Hamiltonian-splitting-method"><span>Time discretization: Hamiltonian splitting method</span></a></li><li><a class="tocitem" href="#Fully-discrete-numerical-scheme"><span>Fully discrete numerical scheme</span></a></li></ul></li><li><a class="tocitem" href="srs_without_spin/">Validation</a></li><li><a class="tocitem" href="example/">Example</a></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaVlasov/VectorSpinVlasovMaxwell1D1V.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="VectorSpinVlasovMaxwell1D1V"><a class="docs-heading-anchor" href="#VectorSpinVlasovMaxwell1D1V">VectorSpinVlasovMaxwell1D1V</a><a id="VectorSpinVlasovMaxwell1D1V-1"></a><a class="docs-heading-anchor-permalink" href="#VectorSpinVlasovMaxwell1D1V" title="Permalink"></a></h1><h2 id="Scalar-spin-laser-plasma-model"><a class="docs-heading-anchor" href="#Scalar-spin-laser-plasma-model">Scalar spin laser plasma model</a><a id="Scalar-spin-laser-plasma-model-1"></a><a class="docs-heading-anchor-permalink" href="#Scalar-spin-laser-plasma-model" title="Permalink"></a></h2><p>Particle distribution function <span>$f(x, p, {\mathbf s}, t)$</span>, </p><ul><li><span>$x\in [0,L]$</span>, </li><li><span>$p \in \mathbb{R}$</span> are scalars, </li><li><span>${\mathbf s}=(s_1,s_2,s_3) \in \mathbb{R}^3$</span>, </li><li><span>${\mathbf E} = (E_x, {\mathbf E}_\perp) = (E_x, E_y, E_z)$</span>, </li><li><span>${\mathbf A} = (A_x, {\mathbf A}_\perp) = (0, A_y, A_z)$</span>, </li><li><span>${\mathbf B} =\nabla\times{\mathbf  A} = (0,- \partial_xA_z,  \partial_xA_y)$</span>.</li></ul><p>The scalar spin Vlasov–Maxwell  system is:</p><p class="math-container">\[\left\{
\begin{aligned}
&amp;\frac{\partial f}{\partial t} + p \frac{\partial f}{\partial x} + [ E_x - \mathfrak{h} s_2 \frac{\partial^2 A_z}{\partial x^2} + \mathfrak{h} s_3 \frac{\partial^2 A_y}{\partial x^2}  - {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x} ]\frac{\partial f}{\partial p}  \\ 
&amp; \hspace{3cm}+ [s_3 \frac{\partial A_z}{\partial x} + s_2 \frac{\partial A_y}{\partial x}, -s_1 \frac{\partial A_y}{\partial x}, -s_1 \frac{\partial A_z}{\partial x} ] \cdot \frac{\partial f}{\partial {\mathbf s}} = 0,\\
&amp;\frac{\partial E_x}{\partial t} = -\int_{\mathbb{R}^4} p f  \mathrm{d}{p}\mathrm{d}\mathrm{\mathbf s},\\
&amp;\frac{\partial E_y}{\partial t} = - \frac{\partial^2 A_y}{\partial x^2} + A_y \int_{\mathbb{R}^4}  f  \mathrm{d}{p}\mathrm{d}\mathrm{\mathbf s} + \mathfrak{h}\int_{\mathbb{R}^4} s_3 \frac{\partial f}{\partial x}\mathrm{d}{p}\mathrm{d}\mathrm{\mathbf s},\\
&amp;\frac{\partial E_z}{\partial t} = - \frac{\partial^2 A_z}{\partial x^2} + A_z \int_{\mathbb{R}^4}  f  \mathrm{d}{p}\mathrm{d}\mathrm{\mathbf s} - \mathfrak{h}\int_{\mathbb{R}^4} s_2 \frac{\partial f}{\partial x}\mathrm{d}{p}\mathrm{d}\mathrm{\mathbf s},\\
&amp; \frac{\partial {\mathbf A}_\perp}{\partial t} = - {\mathbf E}_\perp,\\
&amp;\frac{\partial E_x}{\partial x} = \int_{\mathbb{R}^4} f \mathrm{d}{p}\mathrm{d}\mathrm{\mathbf s} - 1. \ \text{(Poisson equation)}
\end{aligned}
\right.\]</p><p>The system numerically solve is the vector model:</p><p class="math-container">\[f(t, x,p,{\mathbf{s}})=\frac{1}{4\pi}(f_0(t, x,p)+3s_1f_1(t, x,p)+3s_2f_2(t, x,p)+3s_3f_3(t, x,p)).\]</p><p class="math-container">\[\left\{
\begin{aligned}
&amp;\frac{\partial f_0}{\partial t} + p \frac{\partial f_0}{\partial x} + \left(E_x - {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x}  \right) \frac{\partial f_0}{\partial p} - \mathfrak{h}\frac{\partial^2 A_z}{\partial x^2}\frac{\partial f_2}{\partial p} +  \mathfrak{h}\frac{\partial^2 A_y}{\partial x^2} \frac{\partial f_3}{\partial p}  = 0,\\
&amp;\frac{\partial f_1}{\partial t} + p \frac{\partial f_1}{\partial x} + \left(E_x - {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x}  \right) \frac{\partial f_1}{\partial p}
 - \frac{\partial A_z }{\partial x}  f_3  -  \frac{\partial A_y }{\partial x} f_2 = 0,\\
&amp; \frac{\partial f_2}{\partial t} + p \frac{\partial f_2}{\partial x} + \left(E_x - {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x}  \right) \frac{\partial f_2}{\partial p} - {\frac{\mathfrak{h}}{3}} \frac{\partial^2 A_z}{\partial x^2}\frac{\partial f_0}{\partial p}
  +  \frac{\partial A_y }{\partial x} f_1 = 0,\\
 &amp; \frac{\partial f_3}{\partial t} + p \frac{\partial f_3}{\partial x} + \left(E_x - {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x}  \right) \frac{\partial f_3}{\partial p} + {\frac{\mathfrak{h}}{3}}  \frac{\partial^2 A_y}{\partial x^2}\frac{\partial f_0}{\partial p}
  +  \frac{\partial A_z }{\partial x} f_1 = 0,\\
&amp;\frac{\partial E_x}{\partial t} = -\int_{\mathbb{R}} p f_0  \mathrm{d}\mathrm{p},\\
&amp;\frac{\partial E_y}{\partial t} = - \frac{\partial^2 A_y}{\partial x^2} + A_y \int_{\mathbb{R}}  f_0  \mathrm{d}\mathrm{p} + \mathfrak{h}\int_{\mathbb{R}}  \frac{\partial f_3}{\partial x}\mathrm{d}\mathrm{p},\\
&amp;\frac{\partial E_z}{\partial t} = - \frac{\partial^2 A_z}{\partial x^2} + A_z \int_{\mathbb{R}}  f_0  \mathrm{d}\mathrm{p} -\mathfrak{h} \int_{\mathbb{R}}  \frac{\partial f_2}{\partial x}\mathrm{d}\mathrm{p},\\
&amp; \frac{\partial {\mathbf A}_\perp}{\partial t} = - {\mathbf E}_\perp,\\
&amp;\frac{\partial E_x}{\partial x} = \int_{\mathbb{R}} f_0 \mathrm{d}\mathrm{p} - 1.\ \text{(Poisson equation)}
\end{aligned}
\right.\]</p><h2 id="Time-discretization:-Hamiltonian-splitting-method"><a class="docs-heading-anchor" href="#Time-discretization:-Hamiltonian-splitting-method">Time discretization: Hamiltonian splitting method</a><a id="Time-discretization:-Hamiltonian-splitting-method-1"></a><a class="docs-heading-anchor-permalink" href="#Time-discretization:-Hamiltonian-splitting-method" title="Permalink"></a></h2><p class="math-container">\[\mathcal{H}=\mathcal{H}_{p}+\mathcal{H}_{A}+\mathcal{H}_{E}+\mathcal{H}_{2}+\mathcal{H}_{3},\]</p><p>where </p><p class="math-container">\[\begin{aligned}
\mathcal{H}_{p} &amp; = \frac{1}{2}\int p^2 f_0 \mathrm{d}{ x}\mathrm{d}{p},\\
\mathcal{H}_{A} &amp;= \frac{1}{2}\int |{\mathbf A}_\perp|^2 f_0 \mathrm{d}{ x}\mathrm{d}{ p}+\frac{1}{2}\int \left|\frac{\partial {\mathbf A}_\perp}{\partial x}\right|^2 \mathrm{d}{x},\\
\mathcal{H}_{E} &amp;= \frac{1}{2}\int |{\mathbf E}|^2  \mathrm{d}{ x}=\frac{1}{2}\int (E_x^2+|{\mathbf E_\perp}|^2 ) \mathrm{d}{ x}, \\
\mathcal{H}_{2} &amp;= \int_{\Omega}  \mathfrak{h} f_2 \frac{\partial A_z}{\partial x} \mathrm{d}x\mathrm{d}p,\\
\mathcal{H}_{3} &amp;= \int_{\Omega}  -\mathfrak{h} f_3 \frac{\partial A_y}{\partial x} \mathrm{d}x\mathrm{d}p.
\end{aligned} \]</p><h3 id="Subsystem-for-\\mathcal{H}_p"><a class="docs-heading-anchor" href="#Subsystem-for-\\mathcal{H}_p">Subsystem for <span>$\mathcal{H}_p$</span></a><a id="Subsystem-for-\\mathcal{H}_p-1"></a><a class="docs-heading-anchor-permalink" href="#Subsystem-for-\\mathcal{H}_p" title="Permalink"></a></h3><p>The subsystem <span>$\frac{\partial \mathcal{Z}}{\partial t} = \{ \mathcal{Z}, \mathcal{H}_p \}$</span> associated to <span>$\mathcal{H}_{p} = \frac{1}{2}\int p^2 f_0 \mathrm{d}{ x}\mathrm{d}{p}$</span> is </p><p class="math-container">\[\left\{
\begin{aligned}
&amp;\frac{\partial f_0}{\partial t} = \{f_0, \mathcal{H}_{p} \} = -p\frac{\partial f_0}{\partial x}, \\
&amp;\frac{\partial \mathbf{f}}{\partial t} = \{\mathbf{f}, \mathcal{H}_{p} \}= -p\frac{\partial \mathbf{f}}{\partial x}, \\
%&amp;\frac{\partial f_1}{\partial t} = \{f_1, \mathcal{H}_{p} \}= -p\frac{\partial f_1}{\partial x}, \\
%&amp;\frac{\partial f_2}{\partial t} = \{f_2, \mathcal{H}_{p} \}= -p\frac{\partial f_2}{\partial x}, \\
%&amp;\frac{\partial f_3}{\partial t} = \{f_3, \mathcal{H}_{p} \}= -p\frac{\partial f_3}{\partial x},\\
&amp; \frac{\partial E_x}{\partial t} = \{ E_x, \mathcal{H}_{p} \} =- \int_{\mathbb{R}} p f_0\mathrm{d}{p},\\
&amp; \frac{\partial {\mathbf E}_\perp}{\partial t} =\frac{\partial {\mathbf A}_\perp}{\partial t} =0. 
%&amp; \frac{\partial {\mathbf E}_\perp}{\partial t} =  \{ {\mathbf E}_\perp, \mathcal{H}_{p} \}  = {\mathbf 0},\;\; \frac{\partial {\mathbf A}_\perp}{\partial t} =  \{ {\mathbf A}_\perp, \mathcal{H}_{p} \}  = {\mathbf 0}.
\end{aligned}
\right.\]</p><p>We denote the initial value as <span>$(f_0^0(x,p),\mathbf{f}^0(x,p), E_x^0(x),{\mathbf E}_\perp^0(x),{\mathbf A}_\perp^0(x))$</span> at time <span>$t=0$</span>. The solution at time <span>$t$</span> of this subsystem can be written explicitly, </p><p class="math-container">\[\begin{aligned}
        &amp;f_0(x,p,t)=f_0^0(x-pt,p), \;\;  \mathbf{f}(x,p,t)=\mathbf{f}^0(x-pt,p),\\ %f_2(x,p,t)=f_2^0(x-pt,p), f_3(x,p,t)=f_3^0(x-pt,p), \\
        &amp;E_x(x,t)=E_x^0(x)-\int_0^t\int_{\mathbb{R}} pf_0(x,p,\tau) \mathrm{d}p\mathrm{d}\tau=E_x^0(x)-\int_0^t\int_{\mathbb{R}} pf_0^0(x-p\tau,p) \mathrm{d}p\mathrm{d}\tau, \\
        &amp;{\mathbf E}_\perp(x,t)={\mathbf E}_\perp^0(x), \;\; {\mathbf A}_\perp(x,t)={\mathbf A}_\perp^0(x). 
    \end{aligned}\]</p><p>Next, we check that the solution propagates the Poisson equation. To do so, we assume that the Poisson equation holds initially, i.e.</p><p class="math-container">\[\frac{\partial E_x^0}{\partial x}=\int_{\mathbb{R}} f_0^0\mathrm{d}{p}-1.\]</p><p>Then we have, by differentiating the expression of <span>$E_x(t, x)$</span> with respect to <span>$x$</span> </p><p class="math-container">\[\begin{aligned}
\frac{\partial E_x(x,t)}{\partial x}&amp;=\frac{\partial E_x^0}{\partial x}-\int_0^t\int_{\mathbb{R}} p\frac{\partial f_0^0(x-p\tau,p)}{\partial x} \mathrm{d}p\mathrm{d}\tau=\frac{\partial E_x^0}{\partial x}+\int_0^t\int_{\mathbb{R}} \frac{\partial f_0^0(x-p\tau,p)}{\partial \tau} \mathrm{d}p\mathrm{d}\tau\\
&amp;=\frac{\partial E_x^0}{\partial x}+\int_{\mathbb{R}}  f_0^0(x-pt,p)\mathrm{d}p-\int_{\mathbb{R}}  f_0^0(x,p)\mathrm{d}p=\int_{\mathbb{R}}  f_0(x,p,t)\mathrm{d}p-1, 
\end{aligned}\]</p><p>which proves that the Poisson equation is satisfied at time <span>$t$</span>.</p><h3 id="Subsystem-for-\\mathcal{H}_A"><a class="docs-heading-anchor" href="#Subsystem-for-\\mathcal{H}_A">Subsystem for <span>$\mathcal{H}_A$</span></a><a id="Subsystem-for-\\mathcal{H}_A-1"></a><a class="docs-heading-anchor-permalink" href="#Subsystem-for-\\mathcal{H}_A" title="Permalink"></a></h3><p>The subsystem <span>$\frac{\partial \mathcal{Z}}{\partial t} = \{ \mathcal{Z}, \mathcal{H}_A \}$</span> associated to the sub-Hamiltonian <span>$\mathcal{H}_{A} = \frac{1}{2}\int |{\mathbf A}_\perp|^2 f_0 \mathrm{d}{\mathbf x}\mathrm{d}{\mathbf p}+\frac{1}{2}\int |\frac{\partial {\mathbf A}_\perp}{\partial x}|^2 \mathrm{d}{\mathbf x}$</span> is </p><p class="math-container">\[\left\{
\begin{aligned}
&amp;\frac{\partial f_0}{\partial t} = \{f_0, \mathcal{H}_{A} \} = {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x}\frac{\partial f_0}{\partial p}, \\
&amp;\frac{\partial {\mathbf f}}{\partial t} = \{{\mathbf f}, \mathcal{H}_{A} \}= {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x} \frac{\partial {\mathbf f}}{\partial p}, \\
%&amp;\frac{\partial f_2}{\partial t} = \{f_2, \mathcal{H}_{A} \}= {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x} \frac{\partial f_2}{\partial p}, \\
%&amp;\frac{\partial f_3}{\partial t} = \{f_3, \mathcal{H}_{A} \}= {\mathbf A}_\perp \cdot \frac{\partial {\mathbf A}_\perp}{\partial x} \frac{\partial f_3}{\partial p},\\
%&amp; \frac{\partial E_x}{\partial t} = \{ E_x, \mathcal{H}_{A} \} = 0,\\
&amp; \frac{\partial {\mathbf E}_\perp}{\partial t} =  \{ {\mathbf E}_\perp, \mathcal{H}_{A} \}  = - \frac{\partial^2 {\mathbf A}_\perp}{\partial x^2} + {\mathbf A}_\perp \int_{\mathbb{R}}  f_0  \mathrm{d}\mathrm{p},\\
&amp; \frac{\partial E_x}{\partial t} =\frac{\partial {\mathbf A}_\perp}{\partial t} = 0. % \{ {\mathbf A}_\perp, \mathcal{H}_{A} \}  = {\mathbf 0}.
\end{aligned}
\right.\]</p><p>We denote by <span>$(f_0^0(x,p),{\mathbf f}^0(x,p), E_x^0(x),{\mathbf E}_\perp^0(x),{\mathbf A}_\perp^0(x))$</span> the initial value at time <span>$t=0$</span>. The exact solution at time t is,</p><p class="math-container">\[\begin{aligned}
        &amp;f_0(x,p,t)=f_0^0 \left( x,p+t{\mathbf A}_\perp^0(x) \cdot \frac{\partial {\mathbf A}_\perp^0(x)}{\partial x}  \right) ,\\
&amp;   {\mathbf f}(x,p,t)={\mathbf f}^0 \left( x,p+t{\mathbf A}_\perp^0(x) \cdot \frac{\partial {\mathbf A}_\perp^0(x)}{\partial x}  \right), \\
        &amp;{\mathbf E}_\perp(x,t)={\mathbf E}_\perp^0(x)-t\frac{\partial^2 {\mathbf A}_\perp^0(x)}{\partial x^2} +t{\mathbf A}_\perp^0(x)\int_{\mathbb{R}} f_0^0(x,p) \mathrm{d}p, \\
        &amp;E_x(x,t)=E_x^0(x), \;\; {\mathbf A}_\perp(x,t)={\mathbf A}_\perp^0(x), \\
\end{aligned}\]</p><h3 id="Subsystem-for-\\mathcal{H}_E"><a class="docs-heading-anchor" href="#Subsystem-for-\\mathcal{H}_E">Subsystem for <span>$\mathcal{H}_E$</span></a><a id="Subsystem-for-\\mathcal{H}_E-1"></a><a class="docs-heading-anchor-permalink" href="#Subsystem-for-\\mathcal{H}_E" title="Permalink"></a></h3><p>The subsystem <span>$\frac{\partial \mathcal{Z}}{\partial t} = \{ \mathcal{Z}, \mathcal{H}_E \}$</span> associated to the sub-Hamiltonian <span>$\mathcal{H}_{E} = \frac{1}{2}\int |{\mathbf E}|^2  \mathrm{d}{\mathbf x}$</span> is </p><p class="math-container">\[\left\{
\begin{aligned}
&amp;\frac{\partial f_0}{\partial t} = \{f_0, \mathcal{H}_{E} \} = -E_x \frac{\partial f_0}{\partial p}, \\
&amp;\frac{\partial {\mathbf f}}{\partial t} = \{{\mathbf f}, \mathcal{H}_{E} \}= -E_x \frac{\partial {\mathbf f}}{\partial p}, \\
%&amp;\frac{\partial f_2}{\partial t} = \{f_2, \mathcal{H}_{E} \}= -E_x \frac{\partial f_2}{\partial p}, \\
%&amp;\frac{\partial f_3}{\partial t} = \{f_3, \mathcal{H}_{E} \}=-E_x \frac{\partial f_3}{\partial p},\\
%&amp; \frac{\partial E_x}{\partial t} = \{ E_x, \mathcal{H}_{E} \} = 0,\\
&amp; \frac{\partial {\mathbf E}_\perp}{\partial t} =  \{ {\mathbf E}_\perp, \mathcal{H}_{E} \}  = {\mathbf 0},\\
&amp; \frac{\partial E_x}{\partial t} = \frac{\partial {\mathbf A}_\perp}{\partial t} = 0. % \{ {\mathbf A}_\perp, \mathcal{H}_{E} \}  =  -{\mathbf E}_\perp.
\end{aligned}
\right.\]</p><p>With the initial value<span>$(f_0^0(x,p),{\mathbf f}^0(x,p),E_x^0(x),{\mathbf E}_\perp^0(x),{\mathbf A}_\perp^0(x))$</span> at time <span>$t=0$</span>, the solution at time t is as follows, </p><p class="math-container">\[\begin{aligned}
&amp; f_0(x,p,t)=f_0^0 ( x,p-tE_x^0(x) ), \\
&amp; {\mathbf f}(x,p,t)={\mathbf f}^0 ( x,p-tE_x^0(x) ),  \\
&amp; E_x(x,t)=E_x^0(x), \\
&amp; {\mathbf E}_\perp(x,t)={\mathbf E}_\perp^0(x), \\
&amp; {\mathbf A}_\perp(x,t)={\mathbf A}_\perp^0(x) -t{\mathbf E}_\perp^0(x).
\end{aligned}\]</p><h3 id="Subsystem-for-\\mathcal{H}_2"><a class="docs-heading-anchor" href="#Subsystem-for-\\mathcal{H}_2">Subsystem for <span>$\mathcal{H}_2$</span></a><a id="Subsystem-for-\\mathcal{H}_2-1"></a><a class="docs-heading-anchor-permalink" href="#Subsystem-for-\\mathcal{H}_2" title="Permalink"></a></h3><p>The subsystem <span>$\frac{\partial \mathcal{Z}}{\partial t} = \{ \mathcal{Z}, \mathcal{H}_2 \}$</span> associated to the sub-Hamiltonian <span>$\mathcal{H}_{2} = \int_{\Omega}  \mathfrak{h} f_2 \frac{\partial A_z}{\partial x} \mathrm{d}x\mathrm{d}p$</span> is </p><p class="math-container">\[\left\{
\begin{aligned}
&amp;\frac{\partial f_0}{\partial t} = \{f_0, \mathcal{H}_{2} \} = \mathfrak{h}\frac{\partial^2 A_z}{\partial x^2}\frac{\partial f_2}{\partial p},  \\
&amp;\frac{\partial f_1}{\partial t} = \{f_1, \mathcal{H}_{2} \}= \frac{\partial A_z }{\partial x}  f_3, \\
&amp;\frac{\partial f_2}{\partial t} = \{f_2, \mathcal{H}_{2} \}= {{\frac{\mathfrak{h}}{3}}} \frac{\partial^2 A_z}{\partial x^2}\frac{\partial f_0}{\partial p}, \\
&amp;\frac{\partial f_3}{\partial t} = \{f_3, \mathcal{H}_{2} \}= -\frac{\partial A_z }{\partial x} f_1,\\
&amp; \frac{\partial { E}_z}{\partial t} =  \{ {E}_z, \mathcal{H}_{2} \}  =-\mathfrak{h}{ \int_{\mathbb{R}}  \frac{\partial f_2}{\partial x}\mathrm{d}{p}},\\
&amp; \frac{\partial E_x}{\partial t} =\frac{\partial { E}_y}{\partial t} =\frac{\partial {\mathbf A}_\perp}{\partial t} =0. 
\end{aligned}
\right.\]</p><p>In this subsystem, we observe some coupling between the distribution functions. To write down the exact solution, we reformulate the equations on <span>$(f_0, {\mathbf f})$</span> as, using <span>$A_z(x, t)=A_z^0(x)$</span></p><p class="math-container">\[    \begin{aligned}
    &amp; \partial_t    \begin{pmatrix}
            f_1  \\
            f_3
        \end{pmatrix}-\frac{\partial A_z^0 }{\partial x} J \begin{pmatrix}
f_1  \\
f_3
\end{pmatrix} =0,  \\
&amp; \partial_t    \begin{pmatrix}
    f_0 \\
    f_2
\end{pmatrix}-\mathfrak{h}\frac{\partial^2 A_z^0}{\partial x^2} \begin{pmatrix}
    0 &amp; 1 \\
    \frac{1}{3}&amp; 0
\end{pmatrix} \partial_p    \begin{pmatrix}
f_0 \\
f_2
\end{pmatrix} =0, \\
    \end{aligned}\]</p><p>where <span>$J$</span> denotes the symplectic matrix</p><p class="math-container">\[J=\begin{pmatrix}
    0 &amp; 1 \\
-1 &amp; 0
\end{pmatrix}.\]</p><p>With the initial value <span>$(f_0^0(x,p),{\mathbf f}^0(x,p),E_x^0(x),{\mathbf E}_\perp^0(x),{\mathbf A}_\perp^0(x))$</span> at time <span>$t=0$</span>, the exact solution for the first system is</p><p class="math-container">\[\begin{pmatrix}
            f_1  \\
            f_3
        \end{pmatrix}(x,p,t)=\exp{\left(\frac{\partial A_z^0(x) }{\partial x} J t\right)}\begin{pmatrix}
f_1^0(x,p)  \\
f_3^0(x,p)
\end{pmatrix},\  \text{with}\ \exp{(Js)}=\begin{pmatrix}
    \cos(s) &amp; \sin(s) \\
-\sin(s) &amp; \cos(s)
\end{pmatrix}.\]</p><p>Let us now focus on the second system</p><p class="math-container">\[\partial_t  \begin{pmatrix}
    f_0 \\
    f_2
\end{pmatrix}-\mathfrak{h}\frac{\partial^2 A_z^0}{\partial x^2} \begin{pmatrix}
    0 &amp; 1 \\
    \frac{1}{3}&amp; 0
\end{pmatrix} \partial_p    \begin{pmatrix}
f_0 \\
f_2
\end{pmatrix} =0. \]</p><p>By the eigen-decomposition </p><p class="math-container">\[\begin{pmatrix}
    \frac{1}{2} &amp; \frac{\sqrt{3}}{2} \\
    \frac{1}{2}&amp; -\frac{\sqrt{3}}{2}
\end{pmatrix}
\begin{pmatrix}
    0 &amp; 1 \\
    \frac{1}{3}&amp; 0
\end{pmatrix}
\begin{pmatrix}
    1 &amp; 1 \\
    \frac{1}{\sqrt{3}}&amp; \frac{-1}{\sqrt{3}}
\end{pmatrix}
=\begin{pmatrix}
\frac{1}{\sqrt{3}}&amp; 0 \\
    0&amp; -\frac{1}{\sqrt{3}}
\end{pmatrix},\]</p><p>then, one can diagonalize the transport equation to get</p><p class="math-container">\[\partial_t  \begin{pmatrix}
    \frac{1}{2}f_0+\frac{\sqrt{3}}{2}f_2 \\
    \frac{1}{2}f_0-\frac{\sqrt{3}}{2}f_2 
\end{pmatrix}- 
\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_z^0}{\partial x^2}
\begin{pmatrix}
    1 &amp; 0 \\
    0&amp; -1
\end{pmatrix} \partial_p    \begin{pmatrix}
    \frac{1}{2}f_0+\frac{\sqrt{3}}{2}f_2 \\
    \frac{1}{2}f_0-\frac{\sqrt{3}}{2}f_2 
\end{pmatrix} =0.
\]</p><p>Thus, we can solve the transport equation</p><p class="math-container">\[\Big(\frac{1}{2}f_0\pm\frac{\sqrt{3}}{2}f_2\Big)(x,p,t)=\Big(\frac{1}{2}f_0^0 \pm\frac{\sqrt{3}}{2}f_2^0\Big)( x,p\pm t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_z^0}{\partial x^2}(x)),\]</p><p>and compute the exact solution at time <span>$t$</span> as follows, </p><p class="math-container">\[\begin{aligned}
        &amp;f_1(x,p,t)=\cos(t \frac{\partial A_z^0(x) }{\partial x} )f_1^0 ( x,p)+\sin(t \frac{\partial A_z^0(x) }{\partial x} )f_3^0 ( x,p), \\
        &amp;f_3(x,p,t)=-\sin(t \frac{\partial A_z^0(x) }{\partial x} )f_1^0 ( x,p)+\cos(t \frac{\partial A_z^0(x) }{\partial x} )f_3^0 ( x,p) \\
        &amp;f_0(x,p,t)=\Big(\frac{1}{2}f_0^0 +\frac{\sqrt{3}}{2}f_2^0\Big)( x,p+t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_z^0}{\partial x^2}(x) )+\Big(\frac{1}{2}f_0^0 -\frac{\sqrt{3}}{2}f_2^0\Big)( x,p-t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_z^0}{\partial x^2}(x) ),\\
        &amp;f_2(x,p,t)=\frac{1}{\sqrt{3}}\Big(\frac{1}{2}f_0^0 +\frac{\sqrt{3}}{2}f_2^0\Big)( x,p+t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_z^0}{\partial x^2}(x) )-\frac{1}{\sqrt{3}}\Big(\frac{1}{2}f_0^0 -\frac{\sqrt{3}}{2}f_2^0\Big)( x,p-t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_z^0}{\partial x^2}(x) ),\\
        &amp;{\mathbf A}_\perp(x,t)={\mathbf A}_\perp^0(x), E_x(x,t)=E_x^0(x), E_y(x,t)=E_y^0(x),\\
        &amp;E_z(x,t)=E_z^0(x)-t\mathfrak{h}\int_{\mathbb{R}} \frac{\partial f_2^0}{\partial x}\mathrm{d}{p}.
    \end{aligned}\]</p><h3 id="Subsystem-for-\\mathcal{H}_3"><a class="docs-heading-anchor" href="#Subsystem-for-\\mathcal{H}_3">Subsystem for <span>$\mathcal{H}_3$</span></a><a id="Subsystem-for-\\mathcal{H}_3-1"></a><a class="docs-heading-anchor-permalink" href="#Subsystem-for-\\mathcal{H}_3" title="Permalink"></a></h3><p>The subsystem <span>$\frac{\partial \mathcal{Z}}{\partial t} = \{ \mathcal{Z}, \mathcal{H}_3 \}$</span> associated to the sub-Hamiltonian <span>$\mathcal{H}_{3} = -\int_{\Omega} \mathfrak{h} f_3 \frac{\partial A_y}{\partial x} \mathrm{d}x\mathrm{d}p$</span> is </p><p class="math-container">\[\left\{
\begin{aligned}
&amp;\frac{\partial f_0}{\partial t} = \{f_0, \mathcal{H}_{3} \} = -\mathfrak{h}\frac{\partial^2 A_y}{\partial x^2} \frac{\partial f_3}{\partial p},  \\
&amp;\frac{\partial f_1}{\partial t} = \{f_1, \mathcal{H}_{3} \}=  \frac{\partial A_y }{\partial x} f_2, \\
&amp;\frac{\partial f_2}{\partial t} = \{f_2, \mathcal{H}_{3} \}= - \frac{\partial A_y }{\partial x} f_1,\\
&amp;\frac{\partial f_3}{\partial t} =- \{f_3, \mathcal{H}_{3} \}= -{{\frac{\mathfrak{h}}{3}}} \frac{\partial^2 A_y}{\partial x^2} \frac{\partial f_0}{\partial p}, \\
&amp; \frac{\partial { E}_y}{\partial t} =  \{ {E}_y, \mathcal{H}_{3} \}  = {\mathfrak{h} \int_{\mathbb{R}}  \frac{\partial f_3}{\partial x}\mathrm{d}{p}},\\
&amp; \frac{\partial E_x}{\partial t} = \frac{\partial { E}_z}{\partial t} = \frac{\partial {\mathbf A}_\perp}{\partial t} =0. 
\end{aligned}
\right.\]</p><p>This subsystem is very similar to the <span>$\mathcal{H}_2$</span> one, hence, as previously, we reformulate the equations on the distribution functions as </p><p class="math-container">\[\begin{aligned}
        &amp; \partial_t    \begin{pmatrix}
            f_1  \\
            f_2
        \end{pmatrix}
        -\frac{\partial A_y^0 }{\partial x} J 
        %\begin{pmatrix}
    %       0 &amp; -1 \\
%           1 &amp; 0
        %\end{pmatrix} 
        \begin{pmatrix}
        f_1  \\
        f_2
    \end{pmatrix} =0, \\
        &amp; \partial_t    \begin{pmatrix}
            f_0 \\
            f_3
        \end{pmatrix}+\mathfrak{h}\frac{\partial^2 A_y^0}{\partial x^2} \begin{pmatrix}
            0 &amp; 1 \\
            \frac{1}{3}&amp; 0
        \end{pmatrix} \partial_p    \begin{pmatrix}
            f_0 \\
            f_3
        \end{pmatrix} =0, \\
    %&amp; \frac{\partial E_x}{\partial t}= 0,\ 
 %\frac{\partial { E}_y}{\partial t} =   {\mathfrak{h} \int_{\mathbb{R}}  \frac{\partial f_3}{\partial x}\mathrm{d}{p}},\\
    %&amp; \frac{\partial { E}_z}{\partial t} =  \{ {E}_z, H_{3} \}  = { 0},\ 
     %\frac{\partial {\mathbf A}_\perp}{\partial t} =  \{ {\mathbf A}_\perp, H_{3} \}  =  0,
    \end{aligned}\]</p><p>with initial value</p><p><span>$(f_0^0(x,p),{\mathbf f}^0(x,p),E_x^0(x),{\mathbf E}_\perp^0(x),{\mathbf A}_\perp^0(x))$</span> at time <span>$t=0$</span>. We derive similar formula with <span>$\mathcal{H}_2$</span> for the exact solution at time <span>$t$</span> </p><p class="math-container">\[\begin{aligned}
        &amp;f_1(x,p,t)=\cos(t \frac{\partial A_y^0(x) }{\partial x} )f_1^0 ( x,p)+\sin(t \frac{\partial A_y^0(x) }{\partial x} )f_2^0 ( x,p), \\
        &amp;f_2(x,p,t)=-\sin(t \frac{\partial A_y^0(x) }{\partial x} )f_1^0 ( x,p)+\cos(t \frac{\partial A_y^0(x) }{\partial x} )f_2^0 ( x,p), \\
        &amp;f_0(x,p,t)=\Big(\frac{1}{2}f_0^0 +\frac{\sqrt{3}}{2}f_3^0\Big)( x,p-t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_y^0}{\partial x^2}(x) )+\Big(\frac{1}{2}f_0^0 -\frac{\sqrt{3}}{2}f_3^0\Big)( x,p+t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_y^0}{\partial x^2}(x) ),\\
        &amp;f_3(x,p,t)=\frac{1}{\sqrt{3}}\Big(\frac{1}{2}f_0^0 +\frac{\sqrt{3}}{2}f_3^0\Big)( x,p-t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_y^0}{\partial x^2}(x) )-\frac{1}{\sqrt{3}}\Big(\frac{1}{2}f_0^0 -\frac{\sqrt{3}}{2}f_3^0\Big)( x,p+t\frac{\mathfrak{h}}{\sqrt{3}}\frac{\partial^2 A_y^0}{\partial x^2}(x) ),
    \end{aligned} \]</p><p class="math-container">\[\begin{aligned}
&amp; E_y(x,t)=E_y^0(x)+t\mathfrak{h}\int_{\mathbb{R}} \frac{\partial f_3^0}{\partial x}\mathrm{d}{p}, \\
&amp; {\mathbf A}_\perp(x,t)={\mathbf A}_\perp^0(x), \\
&amp; E_x(x,t)=E_x^0(x), \\
&amp; E_z(x,t)=E_z^0(x). 
\end{aligned} \]</p><p>To compute the solution <span>$E_y(x,t)$</span>, we use the fact that</p><p class="math-container">\[\int_{\mathbb{R}} f_3(x,p,t) \mathrm{d}p =\int_{\mathbb{R}} f_3^0(x,p)\mathrm{d} p.\]</p><h2 id="Fully-discrete-numerical-scheme"><a class="docs-heading-anchor" href="#Fully-discrete-numerical-scheme">Fully discrete numerical scheme</a><a id="Fully-discrete-numerical-scheme-1"></a><a class="docs-heading-anchor-permalink" href="#Fully-discrete-numerical-scheme" title="Permalink"></a></h2><p>We assume that the computational domain is <span>$[0,L]\times[-P_L,P_R]$</span> for <span>$x$</span> and <span>$v$</span>. The system is periodic in <span>$x$</span>-direction with period <span>$L$</span> and has compact support on <span>$[-P_L,P_R]$</span> in <span>$v$</span>-direction. The mesh is as follows:</p><p class="math-container">\[x_j=(j-1)\Delta x,\ j=1,...,M,\ \Delta x=L/M, \ (M \text{ is odd)}\]</p><p class="math-container">\[p_{\ell-1} = (\ell-1)\Delta p-P_L,\  \ell=1,...,N, \ \Delta p=(P_L+P_L)/N.\]</p><p>We use the spectral Fourier expansion to approximate <span>$E_x$</span> as it is periodic in the <span>$x$</span>-direction,</p><p class="math-container">\[E_{x,j}=\sum_{k=-(M-1)/2}^{(M-1)/2} \hat{E}_{x,k}(t)e^{2\pi ijk/M}, \;\; \text{ for } j=1,...,M.\]</p><p>For the distribution functions <span>$(f_0, {\mathbf f})$</span>, we use a spectral Fourier expansion for the <span>$x$</span>-direction and a finite-volume method for the <span>$p$</span>-direction. For simplicity, we only present the representation for <span>$f_0$</span>, the notations for <span>${\mathbf f}$</span> are the same. Here <span>$f_{0,j,\ell}(t)$</span> denotes the average of <span>$f_0(x_j,p,t)$</span> over a cell <span>$C_\ell=[p_{\ell-1/2}, p_{l+1/2}]$</span> with the midpoint <span>$p_{\ell-1/2}=(\ell-1/2)\Delta p-P_L$</span>, that is,</p><p class="math-container">\[f_{0,j,\ell}(t)=\frac{1}{\Delta p} \int_{C_\ell} f_0(x_j,p,t)\mathrm{d}{p},\]</p><p>and also by Fourier expansion in <span>$x$</span>-direction, then</p><p class="math-container">\[f_{0,j,\ell}(t)=\sum_{k=-(M-1)/2}^{(M-1)/2} \hat{f}_{0,k,\ell}(t)e^{2\pi ijk/M}, \;\; j=1,...,M.\]</p><p>To evaluate the value of <span>$f_0$</span> off-grid in <span>$p$</span>-direction, we need to reconstruct a continuous function by using the cell average quantity <span>$f_{0,j,\ell}$</span>. </p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="srs_without_spin/">Validation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Monday 8 August 2022 22:00">Monday 8 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
